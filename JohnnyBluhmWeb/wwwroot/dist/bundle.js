(()=>{"use strict";var t=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},e=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},n=function(){function n(){}return n.prototype.getPowerData=function(){return t(this,void 0,void 0,(function(){return e(this,(function(t){switch(t.label){case 0:return[4,fetch("https://localhost:7038/api/stravaMongo/GetAllPowerStreams")];case 1:return[4,t.sent().json()];case 2:return[2,t.sent()]}}))}))},n.prototype.getHeartRateData=function(){return t(this,void 0,void 0,(function(){return e(this,(function(t){switch(t.label){case 0:return[4,fetch("https://localhost:7038/api/stravaMongo/GetAllHrStreams")];case 1:return[4,t.sent().json()];case 2:return[2,t.sent()]}}))}))},n.prototype.getActivities=function(){return t(this,void 0,void 0,(function(){return e(this,(function(t){switch(t.label){case 0:return[4,fetch("https://localhost:7038/api/stravaMongo/GetAllActivities")];case 1:return[4,t.sent().json()];case 2:return[2,t.sent()]}}))}))},n.prototype.getDetailedActivities=function(){return t(this,void 0,void 0,(function(){return e(this,(function(t){switch(t.label){case 0:return[4,fetch("https://localhost:7038/api/stravaMongo/GetAllDetailedActivities")];case 1:return[4,t.sent().json()];case 2:return[2,t.sent()]}}))}))},n}();function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function i(t){o(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||"object"===r(t)&&"[object Date]"===e?new Date(t.getTime()):"number"==typeof t||"[object Number]"===e?new Date(t):("string"!=typeof t&&"[object String]"!==e||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}function a(t,e){o(2,arguments);var n=i(t),r=i(e);return n.getTime()>r.getTime()}function s(t,e){o(2,arguments);var n=i(t),r=i(e);return n.getTime()<r.getTime()}var u=function(){function t(){}return t.prototype.getTimeInZoneList=function(t){for(var e={1:0,2:0,3:0,4:0,5:0,6:0,7:0},n=0,r=t;n<r.length;n++){var o=r[n];for(var i in o.powerStream){var a=o.powerStream[i];e[this.getZone(i).toString()]+=Number.parseInt(a)}}return Object.values(e)},t.prototype.getZone=function(t){var e=Number.parseInt(t);return e<=132?1:e>132&&e<=180?2:e>180&&e<=216?3:e>216&&e<=252?4:e>252&&e<=288?5:e>288&&e<=360?6:e>=360?7:1},t.prototype.setPowerZones=function(t){this.powerZones[0]=.55*t,this.powerZones[1]=.75*t,this.powerZones[2]=.87*t,this.powerZones[3]=1.05*t,this.powerZones[4]=1.2*t,this.powerZones[5]=1.5*t,this.powerZones[6]=2*t},t}(),c=function(){function t(){}return t.prototype.getTimeInZoneList=function(t){for(var e={1:0,2:0,3:0,4:0,5:0},n=0,r=t;n<r.length;n++){var o=r[n];for(var i in o.hrStream){var a=o.hrStream[i];e[this.getZone(i).toString()]+=Number.parseInt(a)}}return Object.values(e)},t.prototype.getZone=function(t){var e=Number.parseInt(t);return e<=118?1:e>118&&e<=156?2:e>156&&e<=175?3:e>175&&e<=194?4:e>194?5:1},t.prototype.setHrZones=function(t){this.hrZones[0]=.5*t,this.hrZones[1]=.6*t,this.hrZones[2]=.7*t,this.hrZones[3]=.8*t,this.hrZones[4]=.9*t},t}(),l=function(){function t(t){this.allActivities=t,this.filteredActivities=t}return t.prototype.filterByDate=function(t,e){this.filteredActivities=[];for(var n=0,r=this.allActivities;n<r.length;n++){var o=r[n],i=Date.parse(o.start_date_local);a(i,t)&&s(i,e)&&this.filteredActivities.push(o)}this.setTimeInZoneLists()},t.prototype.setTimeInZoneLists=function(){this.powerTimeInZone=(new u).getTimeInZoneList(this.filteredActivities),this.hrTimeInZone=(new c).getTimeInZoneList(this.filteredActivities)},t}();function f(t){if(null===t||!0===t||!1===t)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function h(t,e){return o(2,arguments),function(t,e){o(2,arguments);var n=i(t),r=f(e);return isNaN(r)?new Date(NaN):r?(n.setDate(n.getDate()+r),n):n}(t,-f(e))}function p(t,e){return o(2,arguments),function(t,e){return o(2,arguments),function(t,e){o(2,arguments);var n=i(t),r=f(e);if(isNaN(r))return new Date(NaN);if(!r)return n;var a=n.getDate(),s=new Date(n.getTime());return s.setMonth(n.getMonth()+r+1,0),a>=s.getDate()?s:(n.setFullYear(s.getFullYear(),s.getMonth(),a),n)}(t,12*f(e))}(t,-f(e))}var v=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},g=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};function y(){return v(this,void 0,void 0,(function(){var t,e,r,o,i,a,s,u,c,f;return g(this,(function(v){switch(v.label){case 0:return document.getElementById("convertPower"),document.getElementById("convertHr"),[4,(t=new n).getPowerData()];case 1:return e=v.sent(),[4,t.getHeartRateData()];case 2:return r=v.sent(),[4,t.getActivities()];case 3:return o=v.sent(),[4,t.getDetailedActivities()];case 4:return i=v.sent(),console.log(o),console.log(i),console.log(r),console.log(e),function(t,e,n){for(var r=function(n){var r=e.find((function(t){return t.id==n.id})),o=t.find((function(t){return t.id==n.id}));n.powerStream=null==o?void 0:o.powerDict,n.hrStream=null==r?void 0:r.heartRateDict},o=0,i=n;o<i.length;o++)r(i[o])}(e,r,o),function(t,e){for(var n=function(t){var n=e.find((function(e){return e.id==t.id}));t.details=n},r=0,o=t;r<o.length;r++)n(o[r])}(o,i),console.log(o),(a=new l(o)).setTimeInZoneLists(),a.filterByDate(h(new Date,30),new Date),s=a.hrTimeInZone,console.log("After 30 days filter"),console.log(s),a.filterByDate(h(new Date,90),new Date),u=a.hrTimeInZone,console.log("After 90 days filter"),console.log(u),a.filterByDate(p(new Date,1),new Date),c=a.hrTimeInZone,console.log("After 1 year filter"),console.log(c),a.filterByDate(p(new Date,5),new Date),f=a.hrTimeInZone,console.log("All time"),console.log(f),[2]}}))}))}v(void 0,void 0,void 0,(function(){var t;return g(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,y()];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.error(t),[3,3];case 3:return[2]}}))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFJQSxNQUNoRStGLEVBQWtCTCxFQUFlNUMsYUFDckM1QyxRQUFRNEUsSUFBSSxZQUNaNUUsUUFBUTRFLElBQUlpQixHLFdBbUJmLG1DLHdEQUVPLE8sc0JBQUEsR0FBTXpCLEssY0FBTixTLCtCQUVBcEUsUUFBUThGLE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3N0cmF2YS8uL3NyYy9hcGlDbGllbnQudHMiLCJ3ZWJwYWNrOi8vc3RyYXZhLy4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3R5cGVvZi5qcyIsIndlYnBhY2s6Ly9zdHJhdmEvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL19saWIvcmVxdWlyZWRBcmdzL2luZGV4LmpzIiwid2VicGFjazovL3N0cmF2YS8uL25vZGVfbW9kdWxlcy9kYXRlLWZucy9lc20vdG9EYXRlL2luZGV4LmpzIiwid2VicGFjazovL3N0cmF2YS8uL25vZGVfbW9kdWxlcy9kYXRlLWZucy9lc20vaXNBZnRlci9pbmRleC5qcyIsIndlYnBhY2s6Ly9zdHJhdmEvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL2lzQmVmb3JlL2luZGV4LmpzIiwid2VicGFjazovL3N0cmF2YS8uL3NyYy9wb3dlclpvbmVDYWxjdWxhdG9yLnRzIiwid2VicGFjazovL3N0cmF2YS8uL3NyYy9oclpvbmVDYWxjdWxhdG9yLnRzIiwid2VicGFjazovL3N0cmF2YS8uL3NyYy9kYXRhQ2FsY3VsYXRvci50cyIsIndlYnBhY2s6Ly9zdHJhdmEvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL19saWIvdG9JbnRlZ2VyL2luZGV4LmpzIiwid2VicGFjazovL3N0cmF2YS8uL25vZGVfbW9kdWxlcy9kYXRlLWZucy9lc20vc3ViRGF5cy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zdHJhdmEvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL2FkZERheXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc3RyYXZhLy4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL2VzbS9zdWJZZWFycy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zdHJhdmEvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL2FkZFllYXJzL2luZGV4LmpzIiwid2VicGFjazovL3N0cmF2YS8uL25vZGVfbW9kdWxlcy9kYXRlLWZucy9lc20vYWRkTW9udGhzL2luZGV4LmpzIiwid2VicGFjazovL3N0cmF2YS8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEZXRhaWxlZEFjdGl2aXR5IH0gZnJvbSBcIi4vbW9kZWxzL2RldGFpbGVkQWN0aXZpdHlcIjtcclxuaW1wb3J0IHsgU3RyYXZhQWN0aXZpdHkgfSBmcm9tIFwiLi9tb2RlbHMvc3RyYXZhQWN0aXZpdHlcIjtcclxuaW1wb3J0IHsgU3RyZWFtIH0gZnJvbSBcIi4vbW9kZWxzL3N0cmVhbVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFN0cmF2YUFwaUNsaWVudCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuXHJcbiAgICB9XHJcbiAgICBhc3luYyBnZXRQb3dlckRhdGEoKTogUHJvbWlzZTxTdHJlYW1bXT4ge1xyXG4gICAgICAgIHZhciB1cmwgPSBcImh0dHBzOi8vbG9jYWxob3N0OjcwMzgvYXBpL3N0cmF2YU1vbmdvL0dldEFsbFBvd2VyU3RyZWFtc1wiO1xyXG5cclxuICAgICAgICB2YXIgcmVzdWx0ID0gYXdhaXQgZmV0Y2godXJsKTtcclxuICAgICAgICB2YXIgZGF0YSA9IGF3YWl0IHJlc3VsdC5qc29uKCkgYXMgU3RyZWFtW107XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgZ2V0SGVhcnRSYXRlRGF0YSgpOiBQcm9taXNlPFN0cmVhbVtdPiB7XHJcbiAgICAgICAgdmFyIHVybCA9IFwiaHR0cHM6Ly9sb2NhbGhvc3Q6NzAzOC9hcGkvc3RyYXZhTW9uZ28vR2V0QWxsSHJTdHJlYW1zXCI7XHJcblxyXG4gICAgICAgIHZhciByZXN1bHQgPSBhd2FpdCBmZXRjaCh1cmwpO1xyXG4gICAgICAgIHZhciBkYXRhID0gYXdhaXQgcmVzdWx0Lmpzb24oKSBhcyBTdHJlYW1bXTtcclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBnZXRBY3Rpdml0aWVzKCk6IFByb21pc2U8U3RyYXZhQWN0aXZpdHlbXT4ge1xyXG4gICAgICAgIHZhciB1cmwgPSBcImh0dHBzOi8vbG9jYWxob3N0OjcwMzgvYXBpL3N0cmF2YU1vbmdvL0dldEFsbEFjdGl2aXRpZXNcIjtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gYXdhaXQgZmV0Y2godXJsKTtcclxuICAgICAgICB2YXIgZGF0YSA9IGF3YWl0IHJlc3VsdC5qc29uKCkgYXMgU3RyYXZhQWN0aXZpdHlbXTtcclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBnZXREZXRhaWxlZEFjdGl2aXRpZXMoKTogUHJvbWlzZTxEZXRhaWxlZEFjdGl2aXR5W10+IHtcclxuICAgICAgICB2YXIgdXJsID0gXCJodHRwczovL2xvY2FsaG9zdDo3MDM4L2FwaS9zdHJhdmFNb25nby9HZXRBbGxEZXRhaWxlZEFjdGl2aXRpZXNcIjtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gYXdhaXQgZmV0Y2godXJsKTtcclxuICAgICAgICB2YXIgZGF0YSA9IGF3YWl0IHJlc3VsdC5qc29uKCkgYXMgRGV0YWlsZWRBY3Rpdml0eVtdO1xyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gX3R5cGVvZihvYmopIHtcbiAgXCJAYmFiZWwvaGVscGVycyAtIHR5cGVvZlwiO1xuXG4gIHJldHVybiBfdHlwZW9mID0gXCJmdW5jdGlvblwiID09IHR5cGVvZiBTeW1ib2wgJiYgXCJzeW1ib2xcIiA9PSB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID8gZnVuY3Rpb24gKG9iaikge1xuICAgIHJldHVybiB0eXBlb2Ygb2JqO1xuICB9IDogZnVuY3Rpb24gKG9iaikge1xuICAgIHJldHVybiBvYmogJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiBTeW1ib2wgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7XG4gIH0sIF90eXBlb2Yob2JqKTtcbn0iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiByZXF1aXJlZEFyZ3MocmVxdWlyZWQsIGFyZ3MpIHtcbiAgaWYgKGFyZ3MubGVuZ3RoIDwgcmVxdWlyZWQpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHJlcXVpcmVkICsgJyBhcmd1bWVudCcgKyAocmVxdWlyZWQgPiAxID8gJ3MnIDogJycpICsgJyByZXF1aXJlZCwgYnV0IG9ubHkgJyArIGFyZ3MubGVuZ3RoICsgJyBwcmVzZW50Jyk7XG4gIH1cbn0iLCJpbXBvcnQgX3R5cGVvZiBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdHlwZW9mXCI7XG5pbXBvcnQgcmVxdWlyZWRBcmdzIGZyb20gXCIuLi9fbGliL3JlcXVpcmVkQXJncy9pbmRleC5qc1wiO1xuLyoqXG4gKiBAbmFtZSB0b0RhdGVcbiAqIEBjYXRlZ29yeSBDb21tb24gSGVscGVyc1xuICogQHN1bW1hcnkgQ29udmVydCB0aGUgZ2l2ZW4gYXJndW1lbnQgdG8gYW4gaW5zdGFuY2Ugb2YgRGF0ZS5cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIENvbnZlcnQgdGhlIGdpdmVuIGFyZ3VtZW50IHRvIGFuIGluc3RhbmNlIG9mIERhdGUuXG4gKlxuICogSWYgdGhlIGFyZ3VtZW50IGlzIGFuIGluc3RhbmNlIG9mIERhdGUsIHRoZSBmdW5jdGlvbiByZXR1cm5zIGl0cyBjbG9uZS5cbiAqXG4gKiBJZiB0aGUgYXJndW1lbnQgaXMgYSBudW1iZXIsIGl0IGlzIHRyZWF0ZWQgYXMgYSB0aW1lc3RhbXAuXG4gKlxuICogSWYgdGhlIGFyZ3VtZW50IGlzIG5vbmUgb2YgdGhlIGFib3ZlLCB0aGUgZnVuY3Rpb24gcmV0dXJucyBJbnZhbGlkIERhdGUuXG4gKlxuICogKipOb3RlKio6ICphbGwqIERhdGUgYXJndW1lbnRzIHBhc3NlZCB0byBhbnkgKmRhdGUtZm5zKiBmdW5jdGlvbiBpcyBwcm9jZXNzZWQgYnkgYHRvRGF0ZWAuXG4gKlxuICogQHBhcmFtIHtEYXRlfE51bWJlcn0gYXJndW1lbnQgLSB0aGUgdmFsdWUgdG8gY29udmVydFxuICogQHJldHVybnMge0RhdGV9IHRoZSBwYXJzZWQgZGF0ZSBpbiB0aGUgbG9jYWwgdGltZSB6b25lXG4gKiBAdGhyb3dzIHtUeXBlRXJyb3J9IDEgYXJndW1lbnQgcmVxdWlyZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gQ2xvbmUgdGhlIGRhdGU6XG4gKiBjb25zdCByZXN1bHQgPSB0b0RhdGUobmV3IERhdGUoMjAxNCwgMSwgMTEsIDExLCAzMCwgMzApKVxuICogLy89PiBUdWUgRmViIDExIDIwMTQgMTE6MzA6MzBcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gQ29udmVydCB0aGUgdGltZXN0YW1wIHRvIGRhdGU6XG4gKiBjb25zdCByZXN1bHQgPSB0b0RhdGUoMTM5MjA5ODQzMDAwMClcbiAqIC8vPT4gVHVlIEZlYiAxMSAyMDE0IDExOjMwOjMwXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHRvRGF0ZShhcmd1bWVudCkge1xuICByZXF1aXJlZEFyZ3MoMSwgYXJndW1lbnRzKTtcbiAgdmFyIGFyZ1N0ciA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhcmd1bWVudCk7XG5cbiAgLy8gQ2xvbmUgdGhlIGRhdGVcbiAgaWYgKGFyZ3VtZW50IGluc3RhbmNlb2YgRGF0ZSB8fCBfdHlwZW9mKGFyZ3VtZW50KSA9PT0gJ29iamVjdCcgJiYgYXJnU3RyID09PSAnW29iamVjdCBEYXRlXScpIHtcbiAgICAvLyBQcmV2ZW50IHRoZSBkYXRlIHRvIGxvc2UgdGhlIG1pbGxpc2Vjb25kcyB3aGVuIHBhc3NlZCB0byBuZXcgRGF0ZSgpIGluIElFMTBcbiAgICByZXR1cm4gbmV3IERhdGUoYXJndW1lbnQuZ2V0VGltZSgpKTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgYXJndW1lbnQgPT09ICdudW1iZXInIHx8IGFyZ1N0ciA9PT0gJ1tvYmplY3QgTnVtYmVyXScpIHtcbiAgICByZXR1cm4gbmV3IERhdGUoYXJndW1lbnQpO1xuICB9IGVsc2Uge1xuICAgIGlmICgodHlwZW9mIGFyZ3VtZW50ID09PSAnc3RyaW5nJyB8fCBhcmdTdHIgPT09ICdbb2JqZWN0IFN0cmluZ10nKSAmJiB0eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICBjb25zb2xlLndhcm4oXCJTdGFydGluZyB3aXRoIHYyLjAuMC1iZXRhLjEgZGF0ZS1mbnMgZG9lc24ndCBhY2NlcHQgc3RyaW5ncyBhcyBkYXRlIGFyZ3VtZW50cy4gUGxlYXNlIHVzZSBgcGFyc2VJU09gIHRvIHBhcnNlIHN0cmluZ3MuIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2RhdGUtZm5zL2RhdGUtZm5zL2Jsb2IvbWFzdGVyL2RvY3MvdXBncmFkZUd1aWRlLm1kI3N0cmluZy1hcmd1bWVudHNcIik7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgY29uc29sZS53YXJuKG5ldyBFcnJvcigpLnN0YWNrKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBEYXRlKE5hTik7XG4gIH1cbn0iLCJpbXBvcnQgdG9EYXRlIGZyb20gXCIuLi90b0RhdGUvaW5kZXguanNcIjtcbmltcG9ydCByZXF1aXJlZEFyZ3MgZnJvbSBcIi4uL19saWIvcmVxdWlyZWRBcmdzL2luZGV4LmpzXCI7XG4vKipcbiAqIEBuYW1lIGlzQWZ0ZXJcbiAqIEBjYXRlZ29yeSBDb21tb24gSGVscGVyc1xuICogQHN1bW1hcnkgSXMgdGhlIGZpcnN0IGRhdGUgYWZ0ZXIgdGhlIHNlY29uZCBvbmU/XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBJcyB0aGUgZmlyc3QgZGF0ZSBhZnRlciB0aGUgc2Vjb25kIG9uZT9cbiAqXG4gKiBAcGFyYW0ge0RhdGV8TnVtYmVyfSBkYXRlIC0gdGhlIGRhdGUgdGhhdCBzaG91bGQgYmUgYWZ0ZXIgdGhlIG90aGVyIG9uZSB0byByZXR1cm4gdHJ1ZVxuICogQHBhcmFtIHtEYXRlfE51bWJlcn0gZGF0ZVRvQ29tcGFyZSAtIHRoZSBkYXRlIHRvIGNvbXBhcmUgd2l0aFxuICogQHJldHVybnMge0Jvb2xlYW59IHRoZSBmaXJzdCBkYXRlIGlzIGFmdGVyIHRoZSBzZWNvbmQgZGF0ZVxuICogQHRocm93cyB7VHlwZUVycm9yfSAyIGFyZ3VtZW50cyByZXF1aXJlZFxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBJcyAxMCBKdWx5IDE5ODkgYWZ0ZXIgMTEgRmVicnVhcnkgMTk4Nz9cbiAqIGNvbnN0IHJlc3VsdCA9IGlzQWZ0ZXIobmV3IERhdGUoMTk4OSwgNiwgMTApLCBuZXcgRGF0ZSgxOTg3LCAxLCAxMSkpXG4gKiAvLz0+IHRydWVcbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNBZnRlcihkaXJ0eURhdGUsIGRpcnR5RGF0ZVRvQ29tcGFyZSkge1xuICByZXF1aXJlZEFyZ3MoMiwgYXJndW1lbnRzKTtcbiAgdmFyIGRhdGUgPSB0b0RhdGUoZGlydHlEYXRlKTtcbiAgdmFyIGRhdGVUb0NvbXBhcmUgPSB0b0RhdGUoZGlydHlEYXRlVG9Db21wYXJlKTtcbiAgcmV0dXJuIGRhdGUuZ2V0VGltZSgpID4gZGF0ZVRvQ29tcGFyZS5nZXRUaW1lKCk7XG59IiwiaW1wb3J0IHRvRGF0ZSBmcm9tIFwiLi4vdG9EYXRlL2luZGV4LmpzXCI7XG5pbXBvcnQgcmVxdWlyZWRBcmdzIGZyb20gXCIuLi9fbGliL3JlcXVpcmVkQXJncy9pbmRleC5qc1wiO1xuLyoqXG4gKiBAbmFtZSBpc0JlZm9yZVxuICogQGNhdGVnb3J5IENvbW1vbiBIZWxwZXJzXG4gKiBAc3VtbWFyeSBJcyB0aGUgZmlyc3QgZGF0ZSBiZWZvcmUgdGhlIHNlY29uZCBvbmU/XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBJcyB0aGUgZmlyc3QgZGF0ZSBiZWZvcmUgdGhlIHNlY29uZCBvbmU/XG4gKlxuICogQHBhcmFtIHtEYXRlfE51bWJlcn0gZGF0ZSAtIHRoZSBkYXRlIHRoYXQgc2hvdWxkIGJlIGJlZm9yZSB0aGUgb3RoZXIgb25lIHRvIHJldHVybiB0cnVlXG4gKiBAcGFyYW0ge0RhdGV8TnVtYmVyfSBkYXRlVG9Db21wYXJlIC0gdGhlIGRhdGUgdG8gY29tcGFyZSB3aXRoXG4gKiBAcmV0dXJucyB7Qm9vbGVhbn0gdGhlIGZpcnN0IGRhdGUgaXMgYmVmb3JlIHRoZSBzZWNvbmQgZGF0ZVxuICogQHRocm93cyB7VHlwZUVycm9yfSAyIGFyZ3VtZW50cyByZXF1aXJlZFxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBJcyAxMCBKdWx5IDE5ODkgYmVmb3JlIDExIEZlYnJ1YXJ5IDE5ODc/XG4gKiBjb25zdCByZXN1bHQgPSBpc0JlZm9yZShuZXcgRGF0ZSgxOTg5LCA2LCAxMCksIG5ldyBEYXRlKDE5ODcsIDEsIDExKSlcbiAqIC8vPT4gZmFsc2VcbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNCZWZvcmUoZGlydHlEYXRlLCBkaXJ0eURhdGVUb0NvbXBhcmUpIHtcbiAgcmVxdWlyZWRBcmdzKDIsIGFyZ3VtZW50cyk7XG4gIHZhciBkYXRlID0gdG9EYXRlKGRpcnR5RGF0ZSk7XG4gIHZhciBkYXRlVG9Db21wYXJlID0gdG9EYXRlKGRpcnR5RGF0ZVRvQ29tcGFyZSk7XG4gIHJldHVybiBkYXRlLmdldFRpbWUoKSA8IGRhdGVUb0NvbXBhcmUuZ2V0VGltZSgpO1xufSIsImltcG9ydCB7IENoYXJ0LCBDaGFydENvbmZpZ3VyYXRpb24sIENoYXJ0SXRlbSwgQ2hhcnRUeXBlLCBDaGFydFR5cGVSZWdpc3RyeSB9IGZyb20gXCJjaGFydC5qcy9hdXRvXCI7XHJcbmltcG9ydCB7IENoYXJ0R2VuZXJhdG9yIH0gZnJvbSBcIi4vY2hhcnRHZW5lcmF0b3JcIjtcclxuaW1wb3J0IHsgU3RyYXZhQWN0aXZpdHkgfSBmcm9tIFwiLi9tb2RlbHMvc3RyYXZhQWN0aXZpdHlcIjtcclxuaW1wb3J0IHsgU3RyZWFtIH0gZnJvbSBcIi4vbW9kZWxzL3N0cmVhbVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvd2VyWm9uZSB7XHJcbiAgICBwb3dlclpvbmVzOiBudW1iZXJbXTtcclxuXHJcbiAgICBwdWJsaWMgZ2V0VGltZUluWm9uZUxpc3QoYWN0aXZpdGllczogU3RyYXZhQWN0aXZpdHlbXSk6IG51bWJlcltdIHtcclxuICAgICAgICBsZXQgdGltZUluWm9uZURpY3Q6IHsgW2luZGV4OiBzdHJpbmddOiBudW1iZXIgfSA9IHtcclxuICAgICAgICAgICAgXCIxXCI6IDAsXHJcbiAgICAgICAgICAgIFwiMlwiOiAwLFxyXG4gICAgICAgICAgICBcIjNcIjogMCxcclxuICAgICAgICAgICAgXCI0XCI6IDAsXHJcbiAgICAgICAgICAgIFwiNVwiOiAwLFxyXG4gICAgICAgICAgICBcIjZcIjogMCxcclxuICAgICAgICAgICAgXCI3XCI6IDAsXHJcbiAgICAgICAgfTtcclxuICAgICAgICBmb3IgKGxldCBhY3Rpdml0eSBvZiBhY3Rpdml0aWVzKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGtleSBpbiBhY3Rpdml0eS5wb3dlclN0cmVhbSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHRpbWVBdFBvd2VySW5TZWNvbmRzID0gYWN0aXZpdHkucG93ZXJTdHJlYW1ba2V5XTtcclxuICAgICAgICAgICAgICAgIGxldCB6b25lID0gdGhpcy5nZXRab25lKGtleSk7XHJcbiAgICAgICAgICAgICAgICBsZXQgem9uZVN0cmluZyA9IHpvbmUudG9TdHJpbmcoKSBhcyBzdHJpbmc7XHJcbiAgICAgICAgICAgICAgICB0aW1lSW5ab25lRGljdFt6b25lU3RyaW5nXSArPSBOdW1iZXIucGFyc2VJbnQodGltZUF0UG93ZXJJblNlY29uZHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyh0aW1lSW5ab25lRGljdCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRab25lKHBvd2VyOiBzdHJpbmcpOiBudW1iZXIge1xyXG4gICAgICAgIHZhciBwb3dlckFzTnVtYmVyID0gTnVtYmVyLnBhcnNlSW50KHBvd2VyKTtcclxuICAgICAgICBpZiAocG93ZXJBc051bWJlciA8PSAxMzIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHBvd2VyQXNOdW1iZXIgPiAxMzIgJiYgcG93ZXJBc051bWJlciA8PSAxODApIHtcclxuICAgICAgICAgICAgcmV0dXJuIDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHBvd2VyQXNOdW1iZXIgPiAxODAgJiYgcG93ZXJBc051bWJlciA8PSAyMTYpIHtcclxuICAgICAgICAgICAgcmV0dXJuIDM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHBvd2VyQXNOdW1iZXIgPiAyMTYgJiYgcG93ZXJBc051bWJlciA8PSAyNTIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIDQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHBvd2VyQXNOdW1iZXIgPiAyNTIgJiYgcG93ZXJBc051bWJlciA8PSAyODgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIDU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHBvd2VyQXNOdW1iZXIgPiAyODggJiYgcG93ZXJBc051bWJlciA8PSAzNjApIHtcclxuICAgICAgICAgICAgcmV0dXJuIDY7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHBvd2VyQXNOdW1iZXIgPj0gMzYwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiA3O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gMTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldFBvd2VyWm9uZXMoZnRwOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLnBvd2VyWm9uZXNbMF0gPSBmdHAgKiAuNTU7XHJcbiAgICAgICAgdGhpcy5wb3dlclpvbmVzWzFdID0gZnRwICogLjc1O1xyXG4gICAgICAgIHRoaXMucG93ZXJab25lc1syXSA9IGZ0cCAqIC44NztcclxuICAgICAgICB0aGlzLnBvd2VyWm9uZXNbM10gPSBmdHAgKiAxLjA1O1xyXG4gICAgICAgIHRoaXMucG93ZXJab25lc1s0XSA9IGZ0cCAqIDEuMjtcclxuICAgICAgICB0aGlzLnBvd2VyWm9uZXNbNV0gPSBmdHAgKiAxLjU7XHJcbiAgICAgICAgdGhpcy5wb3dlclpvbmVzWzZdID0gZnRwICogMjtcclxuICAgIH1cclxufSIsImltcG9ydCB7IENoYXJ0LCBDaGFydENvbmZpZ3VyYXRpb24sIENoYXJ0SXRlbSwgQ2hhcnRUeXBlLCBDaGFydFR5cGVSZWdpc3RyeSB9IGZyb20gXCJjaGFydC5qcy9hdXRvXCI7XHJcbmltcG9ydCB7IENoYXJ0R2VuZXJhdG9yIH0gZnJvbSBcIi4vY2hhcnRHZW5lcmF0b3JcIjtcclxuaW1wb3J0IHsgU3RyYXZhQWN0aXZpdHkgfSBmcm9tIFwiLi9tb2RlbHMvc3RyYXZhQWN0aXZpdHlcIjtcclxuaW1wb3J0IHsgU3RyZWFtIH0gZnJvbSBcIi4vbW9kZWxzL3N0cmVhbVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEhyWm9uZSB7XHJcbiAgICBoclpvbmVzOiBudW1iZXJbXTtcclxuXHJcbiAgICBwdWJsaWMgZ2V0VGltZUluWm9uZUxpc3QoYWN0aXZpdGllczogU3RyYXZhQWN0aXZpdHlbXSk6IG51bWJlcltdIHtcclxuICAgICAgICBsZXQgdGltZUluWm9uZURpY3Q6IHsgW2luZGV4OiBzdHJpbmddOiBudW1iZXIgfSA9IHtcclxuICAgICAgICAgICAgXCIxXCI6IDAsXHJcbiAgICAgICAgICAgIFwiMlwiOiAwLFxyXG4gICAgICAgICAgICBcIjNcIjogMCxcclxuICAgICAgICAgICAgXCI0XCI6IDAsXHJcbiAgICAgICAgICAgIFwiNVwiOiAwLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZm9yIChsZXQgYWN0aXZpdHkgb2YgYWN0aXZpdGllcykge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBrZXkgaW4gYWN0aXZpdHkuaHJTdHJlYW0pIHtcclxuICAgICAgICAgICAgICAgIGxldCB0aW1lQXRQb3dlckluU2Vjb25kcyA9IGFjdGl2aXR5LmhyU3RyZWFtW2tleV07XHJcbiAgICAgICAgICAgICAgICBsZXQgem9uZSA9IHRoaXMuZ2V0Wm9uZShrZXkpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHpvbmVTdHJpbmcgPSB6b25lLnRvU3RyaW5nKCkgYXMgc3RyaW5nO1xyXG4gICAgICAgICAgICAgICAgdGltZUluWm9uZURpY3Rbem9uZVN0cmluZ10gKz0gTnVtYmVyLnBhcnNlSW50KHRpbWVBdFBvd2VySW5TZWNvbmRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXModGltZUluWm9uZURpY3QpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFpvbmUoaGVhcnRSYXRlOiBzdHJpbmcpOiBudW1iZXIge1xyXG4gICAgICAgIHZhciBwb3dlckFzTnVtYmVyID0gTnVtYmVyLnBhcnNlSW50KGhlYXJ0UmF0ZSk7XHJcbiAgICAgICAgaWYgKHBvd2VyQXNOdW1iZXIgPD0gMTE4KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwb3dlckFzTnVtYmVyID4gMTE4ICYmIHBvd2VyQXNOdW1iZXIgPD0gMTU2KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwb3dlckFzTnVtYmVyID4gMTU2ICYmIHBvd2VyQXNOdW1iZXIgPD0gMTc1KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwb3dlckFzTnVtYmVyID4gMTc1ICYmIHBvd2VyQXNOdW1iZXIgPD0gMTk0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiA0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwb3dlckFzTnVtYmVyID4gMTk0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiA1O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gMTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldEhyWm9uZXMobWF4SHI6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuaHJab25lc1swXSA9IG1heEhyICogLjU7XHJcbiAgICAgICAgdGhpcy5oclpvbmVzWzFdID0gbWF4SHIgKiAuNjtcclxuICAgICAgICB0aGlzLmhyWm9uZXNbMl0gPSBtYXhIciAqIC43O1xyXG4gICAgICAgIHRoaXMuaHJab25lc1szXSA9IG1heEhyICogLjg7XHJcbiAgICAgICAgdGhpcy5oclpvbmVzWzRdID0gbWF4SHIgKiAuOTtcclxuICAgIH1cclxuXHJcbn0iLCJpbXBvcnQgeyBDaGFydCwgQ2hhcnRDb25maWd1cmF0aW9uLCBDaGFydEl0ZW0sIENoYXJ0VHlwZSB9IGZyb20gXCJjaGFydC5qcy9hdXRvXCI7XHJcbmltcG9ydCB7IENoYXJ0R2VuZXJhdG9yIH0gZnJvbSBcIi4vY2hhcnRHZW5lcmF0b3JcIjtcclxuaW1wb3J0IHsgU3RyYXZhQWN0aXZpdHkgfSBmcm9tIFwiLi9tb2RlbHMvc3RyYXZhQWN0aXZpdHlcIjtcclxuaW1wb3J0IHsgU3RyZWFtIH0gZnJvbSBcIi4vbW9kZWxzL3N0cmVhbVwiO1xyXG5pbXBvcnQgeyBUaW1lSW5ab25lRmlsdGVyIH0gZnJvbSBcIi4vdGltZUluWm9uZUZpbHRlclwiO1xyXG5pbXBvcnQgKiBhcyBEYXRlSGVscGVyIGZyb20gJ2RhdGUtZm5zJztcclxuaW1wb3J0IHsgUG93ZXJab25lIH0gZnJvbSBcIi4vcG93ZXJab25lQ2FsY3VsYXRvclwiO1xyXG5pbXBvcnQgeyBIclpvbmUgfSBmcm9tIFwiLi9oclpvbmVDYWxjdWxhdG9yXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgRGF0YUNhbGN1bGF0b3Ige1xyXG4gICAgYWxsQWN0aXZpdGllczogU3RyYXZhQWN0aXZpdHlbXTtcclxuICAgIGZpbHRlcmVkQWN0aXZpdGllczogU3RyYXZhQWN0aXZpdHlbXTtcclxuXHJcbiAgICBoclRpbWVJblpvbmU6IG51bWJlcltdO1xyXG4gICAgcG93ZXJUaW1lSW5ab25lOiBudW1iZXJbXVxyXG4gICAgY2Fsb3JpZXNCdXJuZWRJblRpbWVQZXJpb2Q6IG51bWJlcjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhY3Rpdml0aWVzOiBTdHJhdmFBY3Rpdml0eVtdKSB7XHJcbiAgICAgICAgdGhpcy5hbGxBY3Rpdml0aWVzID0gYWN0aXZpdGllcztcclxuICAgICAgICB0aGlzLmZpbHRlcmVkQWN0aXZpdGllcyA9IGFjdGl2aXRpZXM7XHJcbiAgICB9XHJcblxyXG4gICAgZmlsdGVyQnlEYXRlKGZyb21EYXRlOiBEYXRlLCB0b0RhdGU6IERhdGUpIHtcclxuICAgICAgICB0aGlzLmZpbHRlcmVkQWN0aXZpdGllcyA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGFjdGl2aXR5IG9mIHRoaXMuYWxsQWN0aXZpdGllcykge1xyXG4gICAgICAgICAgICBsZXQgYWN0aXZpdHlEYXRlID0gRGF0ZS5wYXJzZShhY3Rpdml0eS5zdGFydF9kYXRlX2xvY2FsKTtcclxuICAgICAgICAgICAgaWYgKERhdGVIZWxwZXIuaXNBZnRlcihhY3Rpdml0eURhdGUsIGZyb21EYXRlKSAmJiBEYXRlSGVscGVyLmlzQmVmb3JlKGFjdGl2aXR5RGF0ZSwgdG9EYXRlKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJlZEFjdGl2aXRpZXMucHVzaChhY3Rpdml0eSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXRUaW1lSW5ab25lTGlzdHMoKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRUaW1lSW5ab25lTGlzdHMoKSB7XHJcbiAgICAgICAgdGhpcy5wb3dlclRpbWVJblpvbmUgPSBuZXcgUG93ZXJab25lKCkuZ2V0VGltZUluWm9uZUxpc3QodGhpcy5maWx0ZXJlZEFjdGl2aXRpZXMpO1xyXG4gICAgICAgIHRoaXMuaHJUaW1lSW5ab25lID0gbmV3IEhyWm9uZSgpLmdldFRpbWVJblpvbmVMaXN0KHRoaXMuZmlsdGVyZWRBY3Rpdml0aWVzKTtcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHRvSW50ZWdlcihkaXJ0eU51bWJlcikge1xuICBpZiAoZGlydHlOdW1iZXIgPT09IG51bGwgfHwgZGlydHlOdW1iZXIgPT09IHRydWUgfHwgZGlydHlOdW1iZXIgPT09IGZhbHNlKSB7XG4gICAgcmV0dXJuIE5hTjtcbiAgfVxuICB2YXIgbnVtYmVyID0gTnVtYmVyKGRpcnR5TnVtYmVyKTtcbiAgaWYgKGlzTmFOKG51bWJlcikpIHtcbiAgICByZXR1cm4gbnVtYmVyO1xuICB9XG4gIHJldHVybiBudW1iZXIgPCAwID8gTWF0aC5jZWlsKG51bWJlcikgOiBNYXRoLmZsb29yKG51bWJlcik7XG59IiwiaW1wb3J0IGFkZERheXMgZnJvbSBcIi4uL2FkZERheXMvaW5kZXguanNcIjtcbmltcG9ydCByZXF1aXJlZEFyZ3MgZnJvbSBcIi4uL19saWIvcmVxdWlyZWRBcmdzL2luZGV4LmpzXCI7XG5pbXBvcnQgdG9JbnRlZ2VyIGZyb20gXCIuLi9fbGliL3RvSW50ZWdlci9pbmRleC5qc1wiO1xuLyoqXG4gKiBAbmFtZSBzdWJEYXlzXG4gKiBAY2F0ZWdvcnkgRGF5IEhlbHBlcnNcbiAqIEBzdW1tYXJ5IFN1YnRyYWN0IHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIGRheXMgZnJvbSB0aGUgZ2l2ZW4gZGF0ZS5cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFN1YnRyYWN0IHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIGRheXMgZnJvbSB0aGUgZ2l2ZW4gZGF0ZS5cbiAqXG4gKiBAcGFyYW0ge0RhdGV8TnVtYmVyfSBkYXRlIC0gdGhlIGRhdGUgdG8gYmUgY2hhbmdlZFxuICogQHBhcmFtIHtOdW1iZXJ9IGFtb3VudCAtIHRoZSBhbW91bnQgb2YgZGF5cyB0byBiZSBzdWJ0cmFjdGVkLiBQb3NpdGl2ZSBkZWNpbWFscyB3aWxsIGJlIHJvdW5kZWQgdXNpbmcgYE1hdGguZmxvb3JgLCBkZWNpbWFscyBsZXNzIHRoYW4gemVybyB3aWxsIGJlIHJvdW5kZWQgdXNpbmcgYE1hdGguY2VpbGAuXG4gKiBAcmV0dXJucyB7RGF0ZX0gdGhlIG5ldyBkYXRlIHdpdGggdGhlIGRheXMgc3VidHJhY3RlZFxuICogQHRocm93cyB7VHlwZUVycm9yfSAyIGFyZ3VtZW50cyByZXF1aXJlZFxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBTdWJ0cmFjdCAxMCBkYXlzIGZyb20gMSBTZXB0ZW1iZXIgMjAxNDpcbiAqIGNvbnN0IHJlc3VsdCA9IHN1YkRheXMobmV3IERhdGUoMjAxNCwgOCwgMSksIDEwKVxuICogLy89PiBGcmkgQXVnIDIyIDIwMTQgMDA6MDA6MDBcbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gc3ViRGF5cyhkaXJ0eURhdGUsIGRpcnR5QW1vdW50KSB7XG4gIHJlcXVpcmVkQXJncygyLCBhcmd1bWVudHMpO1xuICB2YXIgYW1vdW50ID0gdG9JbnRlZ2VyKGRpcnR5QW1vdW50KTtcbiAgcmV0dXJuIGFkZERheXMoZGlydHlEYXRlLCAtYW1vdW50KTtcbn0iLCJpbXBvcnQgdG9JbnRlZ2VyIGZyb20gXCIuLi9fbGliL3RvSW50ZWdlci9pbmRleC5qc1wiO1xuaW1wb3J0IHRvRGF0ZSBmcm9tIFwiLi4vdG9EYXRlL2luZGV4LmpzXCI7XG5pbXBvcnQgcmVxdWlyZWRBcmdzIGZyb20gXCIuLi9fbGliL3JlcXVpcmVkQXJncy9pbmRleC5qc1wiO1xuLyoqXG4gKiBAbmFtZSBhZGREYXlzXG4gKiBAY2F0ZWdvcnkgRGF5IEhlbHBlcnNcbiAqIEBzdW1tYXJ5IEFkZCB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiBkYXlzIHRvIHRoZSBnaXZlbiBkYXRlLlxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQWRkIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIGRheXMgdG8gdGhlIGdpdmVuIGRhdGUuXG4gKlxuICogQHBhcmFtIHtEYXRlfE51bWJlcn0gZGF0ZSAtIHRoZSBkYXRlIHRvIGJlIGNoYW5nZWRcbiAqIEBwYXJhbSB7TnVtYmVyfSBhbW91bnQgLSB0aGUgYW1vdW50IG9mIGRheXMgdG8gYmUgYWRkZWQuIFBvc2l0aXZlIGRlY2ltYWxzIHdpbGwgYmUgcm91bmRlZCB1c2luZyBgTWF0aC5mbG9vcmAsIGRlY2ltYWxzIGxlc3MgdGhhbiB6ZXJvIHdpbGwgYmUgcm91bmRlZCB1c2luZyBgTWF0aC5jZWlsYC5cbiAqIEByZXR1cm5zIHtEYXRlfSAtIHRoZSBuZXcgZGF0ZSB3aXRoIHRoZSBkYXlzIGFkZGVkXG4gKiBAdGhyb3dzIHtUeXBlRXJyb3J9IC0gMiBhcmd1bWVudHMgcmVxdWlyZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gQWRkIDEwIGRheXMgdG8gMSBTZXB0ZW1iZXIgMjAxNDpcbiAqIGNvbnN0IHJlc3VsdCA9IGFkZERheXMobmV3IERhdGUoMjAxNCwgOCwgMSksIDEwKVxuICogLy89PiBUaHUgU2VwIDExIDIwMTQgMDA6MDA6MDBcbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gYWRkRGF5cyhkaXJ0eURhdGUsIGRpcnR5QW1vdW50KSB7XG4gIHJlcXVpcmVkQXJncygyLCBhcmd1bWVudHMpO1xuICB2YXIgZGF0ZSA9IHRvRGF0ZShkaXJ0eURhdGUpO1xuICB2YXIgYW1vdW50ID0gdG9JbnRlZ2VyKGRpcnR5QW1vdW50KTtcbiAgaWYgKGlzTmFOKGFtb3VudCkpIHtcbiAgICByZXR1cm4gbmV3IERhdGUoTmFOKTtcbiAgfVxuICBpZiAoIWFtb3VudCkge1xuICAgIC8vIElmIDAgZGF5cywgbm8tb3AgdG8gYXZvaWQgY2hhbmdpbmcgdGltZXMgaW4gdGhlIGhvdXIgYmVmb3JlIGVuZCBvZiBEU1RcbiAgICByZXR1cm4gZGF0ZTtcbiAgfVxuICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgKyBhbW91bnQpO1xuICByZXR1cm4gZGF0ZTtcbn0iLCJpbXBvcnQgdG9JbnRlZ2VyIGZyb20gXCIuLi9fbGliL3RvSW50ZWdlci9pbmRleC5qc1wiO1xuaW1wb3J0IGFkZFllYXJzIGZyb20gXCIuLi9hZGRZZWFycy9pbmRleC5qc1wiO1xuaW1wb3J0IHJlcXVpcmVkQXJncyBmcm9tIFwiLi4vX2xpYi9yZXF1aXJlZEFyZ3MvaW5kZXguanNcIjtcbi8qKlxuICogQG5hbWUgc3ViWWVhcnNcbiAqIEBjYXRlZ29yeSBZZWFyIEhlbHBlcnNcbiAqIEBzdW1tYXJ5IFN1YnRyYWN0IHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHllYXJzIGZyb20gdGhlIGdpdmVuIGRhdGUuXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBTdWJ0cmFjdCB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB5ZWFycyBmcm9tIHRoZSBnaXZlbiBkYXRlLlxuICpcbiAqIEBwYXJhbSB7RGF0ZXxOdW1iZXJ9IGRhdGUgLSB0aGUgZGF0ZSB0byBiZSBjaGFuZ2VkXG4gKiBAcGFyYW0ge051bWJlcn0gYW1vdW50IC0gdGhlIGFtb3VudCBvZiB5ZWFycyB0byBiZSBzdWJ0cmFjdGVkLiBQb3NpdGl2ZSBkZWNpbWFscyB3aWxsIGJlIHJvdW5kZWQgdXNpbmcgYE1hdGguZmxvb3JgLCBkZWNpbWFscyBsZXNzIHRoYW4gemVybyB3aWxsIGJlIHJvdW5kZWQgdXNpbmcgYE1hdGguY2VpbGAuXG4gKiBAcmV0dXJucyB7RGF0ZX0gdGhlIG5ldyBkYXRlIHdpdGggdGhlIHllYXJzIHN1YnRyYWN0ZWRcbiAqIEB0aHJvd3Mge1R5cGVFcnJvcn0gMiBhcmd1bWVudHMgcmVxdWlyZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gU3VidHJhY3QgNSB5ZWFycyBmcm9tIDEgU2VwdGVtYmVyIDIwMTQ6XG4gKiBjb25zdCByZXN1bHQgPSBzdWJZZWFycyhuZXcgRGF0ZSgyMDE0LCA4LCAxKSwgNSlcbiAqIC8vPT4gVHVlIFNlcCAwMSAyMDA5IDAwOjAwOjAwXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHN1YlllYXJzKGRpcnR5RGF0ZSwgZGlydHlBbW91bnQpIHtcbiAgcmVxdWlyZWRBcmdzKDIsIGFyZ3VtZW50cyk7XG4gIHZhciBhbW91bnQgPSB0b0ludGVnZXIoZGlydHlBbW91bnQpO1xuICByZXR1cm4gYWRkWWVhcnMoZGlydHlEYXRlLCAtYW1vdW50KTtcbn0iLCJpbXBvcnQgdG9JbnRlZ2VyIGZyb20gXCIuLi9fbGliL3RvSW50ZWdlci9pbmRleC5qc1wiO1xuaW1wb3J0IGFkZE1vbnRocyBmcm9tIFwiLi4vYWRkTW9udGhzL2luZGV4LmpzXCI7XG5pbXBvcnQgcmVxdWlyZWRBcmdzIGZyb20gXCIuLi9fbGliL3JlcXVpcmVkQXJncy9pbmRleC5qc1wiO1xuLyoqXG4gKiBAbmFtZSBhZGRZZWFyc1xuICogQGNhdGVnb3J5IFllYXIgSGVscGVyc1xuICogQHN1bW1hcnkgQWRkIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHllYXJzIHRvIHRoZSBnaXZlbiBkYXRlLlxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQWRkIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHllYXJzIHRvIHRoZSBnaXZlbiBkYXRlLlxuICpcbiAqIEBwYXJhbSB7RGF0ZXxOdW1iZXJ9IGRhdGUgLSB0aGUgZGF0ZSB0byBiZSBjaGFuZ2VkXG4gKiBAcGFyYW0ge051bWJlcn0gYW1vdW50IC0gdGhlIGFtb3VudCBvZiB5ZWFycyB0byBiZSBhZGRlZC4gUG9zaXRpdmUgZGVjaW1hbHMgd2lsbCBiZSByb3VuZGVkIHVzaW5nIGBNYXRoLmZsb29yYCwgZGVjaW1hbHMgbGVzcyB0aGFuIHplcm8gd2lsbCBiZSByb3VuZGVkIHVzaW5nIGBNYXRoLmNlaWxgLlxuICogQHJldHVybnMge0RhdGV9IHRoZSBuZXcgZGF0ZSB3aXRoIHRoZSB5ZWFycyBhZGRlZFxuICogQHRocm93cyB7VHlwZUVycm9yfSAyIGFyZ3VtZW50cyByZXF1aXJlZFxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBBZGQgNSB5ZWFycyB0byAxIFNlcHRlbWJlciAyMDE0OlxuICogY29uc3QgcmVzdWx0ID0gYWRkWWVhcnMobmV3IERhdGUoMjAxNCwgOCwgMSksIDUpXG4gKiAvLz0+IFN1biBTZXAgMDEgMjAxOSAwMDowMDowMFxuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBhZGRZZWFycyhkaXJ0eURhdGUsIGRpcnR5QW1vdW50KSB7XG4gIHJlcXVpcmVkQXJncygyLCBhcmd1bWVudHMpO1xuICB2YXIgYW1vdW50ID0gdG9JbnRlZ2VyKGRpcnR5QW1vdW50KTtcbiAgcmV0dXJuIGFkZE1vbnRocyhkaXJ0eURhdGUsIGFtb3VudCAqIDEyKTtcbn0iLCJpbXBvcnQgdG9JbnRlZ2VyIGZyb20gXCIuLi9fbGliL3RvSW50ZWdlci9pbmRleC5qc1wiO1xuaW1wb3J0IHRvRGF0ZSBmcm9tIFwiLi4vdG9EYXRlL2luZGV4LmpzXCI7XG5pbXBvcnQgcmVxdWlyZWRBcmdzIGZyb20gXCIuLi9fbGliL3JlcXVpcmVkQXJncy9pbmRleC5qc1wiO1xuLyoqXG4gKiBAbmFtZSBhZGRNb250aHNcbiAqIEBjYXRlZ29yeSBNb250aCBIZWxwZXJzXG4gKiBAc3VtbWFyeSBBZGQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgbW9udGhzIHRvIHRoZSBnaXZlbiBkYXRlLlxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQWRkIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIG1vbnRocyB0byB0aGUgZ2l2ZW4gZGF0ZS5cbiAqXG4gKiBAcGFyYW0ge0RhdGV8TnVtYmVyfSBkYXRlIC0gdGhlIGRhdGUgdG8gYmUgY2hhbmdlZFxuICogQHBhcmFtIHtOdW1iZXJ9IGFtb3VudCAtIHRoZSBhbW91bnQgb2YgbW9udGhzIHRvIGJlIGFkZGVkLiBQb3NpdGl2ZSBkZWNpbWFscyB3aWxsIGJlIHJvdW5kZWQgdXNpbmcgYE1hdGguZmxvb3JgLCBkZWNpbWFscyBsZXNzIHRoYW4gemVybyB3aWxsIGJlIHJvdW5kZWQgdXNpbmcgYE1hdGguY2VpbGAuXG4gKiBAcmV0dXJucyB7RGF0ZX0gdGhlIG5ldyBkYXRlIHdpdGggdGhlIG1vbnRocyBhZGRlZFxuICogQHRocm93cyB7VHlwZUVycm9yfSAyIGFyZ3VtZW50cyByZXF1aXJlZFxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBBZGQgNSBtb250aHMgdG8gMSBTZXB0ZW1iZXIgMjAxNDpcbiAqIGNvbnN0IHJlc3VsdCA9IGFkZE1vbnRocyhuZXcgRGF0ZSgyMDE0LCA4LCAxKSwgNSlcbiAqIC8vPT4gU3VuIEZlYiAwMSAyMDE1IDAwOjAwOjAwXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGFkZE1vbnRocyhkaXJ0eURhdGUsIGRpcnR5QW1vdW50KSB7XG4gIHJlcXVpcmVkQXJncygyLCBhcmd1bWVudHMpO1xuICB2YXIgZGF0ZSA9IHRvRGF0ZShkaXJ0eURhdGUpO1xuICB2YXIgYW1vdW50ID0gdG9JbnRlZ2VyKGRpcnR5QW1vdW50KTtcbiAgaWYgKGlzTmFOKGFtb3VudCkpIHtcbiAgICByZXR1cm4gbmV3IERhdGUoTmFOKTtcbiAgfVxuICBpZiAoIWFtb3VudCkge1xuICAgIC8vIElmIDAgbW9udGhzLCBuby1vcCB0byBhdm9pZCBjaGFuZ2luZyB0aW1lcyBpbiB0aGUgaG91ciBiZWZvcmUgZW5kIG9mIERTVFxuICAgIHJldHVybiBkYXRlO1xuICB9XG4gIHZhciBkYXlPZk1vbnRoID0gZGF0ZS5nZXREYXRlKCk7XG5cbiAgLy8gVGhlIEpTIERhdGUgb2JqZWN0IHN1cHBvcnRzIGRhdGUgbWF0aCBieSBhY2NlcHRpbmcgb3V0LW9mLWJvdW5kcyB2YWx1ZXMgZm9yXG4gIC8vIG1vbnRoLCBkYXksIGV0Yy4gRm9yIGV4YW1wbGUsIG5ldyBEYXRlKDIwMjAsIDAsIDApIHJldHVybnMgMzEgRGVjIDIwMTkgYW5kXG4gIC8vIG5ldyBEYXRlKDIwMjAsIDEzLCAxKSByZXR1cm5zIDEgRmViIDIwMjEuICBUaGlzIGlzICphbG1vc3QqIHRoZSBiZWhhdmlvciB3ZVxuICAvLyB3YW50IGV4Y2VwdCB0aGF0IGRhdGVzIHdpbGwgd3JhcCBhcm91bmQgdGhlIGVuZCBvZiBhIG1vbnRoLCBtZWFuaW5nIHRoYXRcbiAgLy8gbmV3IERhdGUoMjAyMCwgMTMsIDMxKSB3aWxsIHJldHVybiAzIE1hciAyMDIxIG5vdCAyOCBGZWIgMjAyMSBhcyBkZXNpcmVkLiBTb1xuICAvLyB3ZSdsbCBkZWZhdWx0IHRvIHRoZSBlbmQgb2YgdGhlIGRlc2lyZWQgbW9udGggYnkgYWRkaW5nIDEgdG8gdGhlIGRlc2lyZWRcbiAgLy8gbW9udGggYW5kIHVzaW5nIGEgZGF0ZSBvZiAwIHRvIGJhY2sgdXAgb25lIGRheSB0byB0aGUgZW5kIG9mIHRoZSBkZXNpcmVkXG4gIC8vIG1vbnRoLlxuICB2YXIgZW5kT2ZEZXNpcmVkTW9udGggPSBuZXcgRGF0ZShkYXRlLmdldFRpbWUoKSk7XG4gIGVuZE9mRGVzaXJlZE1vbnRoLnNldE1vbnRoKGRhdGUuZ2V0TW9udGgoKSArIGFtb3VudCArIDEsIDApO1xuICB2YXIgZGF5c0luTW9udGggPSBlbmRPZkRlc2lyZWRNb250aC5nZXREYXRlKCk7XG4gIGlmIChkYXlPZk1vbnRoID49IGRheXNJbk1vbnRoKSB7XG4gICAgLy8gSWYgd2UncmUgYWxyZWFkeSBhdCB0aGUgZW5kIG9mIHRoZSBtb250aCwgdGhlbiB0aGlzIGlzIHRoZSBjb3JyZWN0IGRhdGVcbiAgICAvLyBhbmQgd2UncmUgZG9uZS5cbiAgICByZXR1cm4gZW5kT2ZEZXNpcmVkTW9udGg7XG4gIH0gZWxzZSB7XG4gICAgLy8gT3RoZXJ3aXNlLCB3ZSBub3cga25vdyB0aGF0IHNldHRpbmcgdGhlIG9yaWdpbmFsIGRheS1vZi1tb250aCB2YWx1ZSB3b24ndFxuICAgIC8vIGNhdXNlIGFuIG92ZXJmbG93LCBzbyBzZXQgdGhlIGRlc2lyZWQgZGF5LW9mLW1vbnRoLiBOb3RlIHRoYXQgd2UgY2FuJ3RcbiAgICAvLyBqdXN0IHNldCB0aGUgZGF0ZSBvZiBgZW5kT2ZEZXNpcmVkTW9udGhgIGJlY2F1c2UgdGhhdCBvYmplY3QgbWF5IGhhdmUgaGFkXG4gICAgLy8gaXRzIHRpbWUgY2hhbmdlZCBpbiB0aGUgdW51c3VhbCBjYXNlIHdoZXJlIHdoZXJlIGEgRFNUIHRyYW5zaXRpb24gd2FzIG9uXG4gICAgLy8gdGhlIGxhc3QgZGF5IG9mIHRoZSBtb250aCBhbmQgaXRzIGxvY2FsIHRpbWUgd2FzIGluIHRoZSBob3VyIHNraXBwZWQgb3JcbiAgICAvLyByZXBlYXRlZCBuZXh0IHRvIGEgRFNUIHRyYW5zaXRpb24uICBTbyB3ZSB1c2UgYGRhdGVgIGluc3RlYWQgd2hpY2ggaXNcbiAgICAvLyBndWFyYW50ZWVkIHRvIHN0aWxsIGhhdmUgdGhlIG9yaWdpbmFsIHRpbWUuXG4gICAgZGF0ZS5zZXRGdWxsWWVhcihlbmRPZkRlc2lyZWRNb250aC5nZXRGdWxsWWVhcigpLCBlbmRPZkRlc2lyZWRNb250aC5nZXRNb250aCgpLCBkYXlPZk1vbnRoKTtcbiAgICByZXR1cm4gZGF0ZTtcbiAgfVxufSIsImltcG9ydCB7IENoYXJ0IH0gZnJvbSBcImNoYXJ0LmpzL2Rpc3RcIjtcclxuaW1wb3J0IHsgU3RyYXZhQXBpQ2xpZW50IH0gZnJvbSBcIi4vYXBpQ2xpZW50XCI7XHJcbmltcG9ydCB7IENoYXJ0R2VuZXJhdG9yIH0gZnJvbSBcIi4vY2hhcnRHZW5lcmF0b3JcIjtcclxuaW1wb3J0IHsgSGVhcnRSYXRlQ2hhcnRHZW5lcmF0b3IgfSBmcm9tIFwiLi9oZWFydFJhdGVDaGFydEdlbmVyYXRvclwiO1xyXG5pbXBvcnQgeyBEYXRhQ2FsY3VsYXRvciB9IGZyb20gXCIuL2RhdGFDYWxjdWxhdG9yXCI7XHJcbmltcG9ydCB7IFN0cmF2YUFjdGl2aXR5IH0gZnJvbSBcIi4vbW9kZWxzL3N0cmF2YUFjdGl2aXR5XCI7XHJcbmltcG9ydCB7IFN0cmVhbSB9IGZyb20gXCIuL21vZGVscy9zdHJlYW1cIjtcclxuaW1wb3J0ICogYXMgRGF0ZUhlbHBlciBmcm9tIFwiZGF0ZS1mbnNcIjtcclxuaW1wb3J0IHsgRGV0YWlsZWRBY3Rpdml0eSB9IGZyb20gXCIuL21vZGVscy9kZXRhaWxlZEFjdGl2aXR5XCI7XHJcblxyXG5cclxuYXN5bmMgZnVuY3Rpb24gbWFpbigpIHtcclxuICAgIC8vbGV0IGJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3dpdGNoUG93ZXJcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XHJcbiAgICAvL2xldCBockJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3dpdGNoSHJcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XHJcblxyXG4gICAgbGV0IHBvd2VyVG9nZ2xlQ2hhcnRCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbnZlcnRQb3dlclwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcclxuICAgIGxldCBoclRvZ2dsZUNoYXJ0QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb252ZXJ0SHJcIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XHJcblxyXG4gICAgbGV0IGNsaWVudCA9IG5ldyBTdHJhdmFBcGlDbGllbnQoKTtcclxuXHJcbiAgICB2YXIgcG93ZXJTdHJlYW1zID0gYXdhaXQgY2xpZW50LmdldFBvd2VyRGF0YSgpO1xyXG4gICAgdmFyIGhyU3RyZWFtcyA9IGF3YWl0IGNsaWVudC5nZXRIZWFydFJhdGVEYXRhKCk7XHJcblxyXG4gICAgdmFyIGFjdGl2aXRpZXMgPSBhd2FpdCBjbGllbnQuZ2V0QWN0aXZpdGllcygpO1xyXG5cclxuICAgIHZhciBkZXRhaWxlZEFjdGl2aXRpZXMgPSBhd2FpdCBjbGllbnQuZ2V0RGV0YWlsZWRBY3Rpdml0aWVzKCk7XHJcbiAgICBjb25zb2xlLmxvZyhhY3Rpdml0aWVzKTtcclxuICAgIGNvbnNvbGUubG9nKGRldGFpbGVkQWN0aXZpdGllcyk7XHJcbiAgICBjb25zb2xlLmxvZyhoclN0cmVhbXMpO1xyXG4gICAgY29uc29sZS5sb2cocG93ZXJTdHJlYW1zKTtcclxuXHJcbiAgICAvKmxldCBwb3dlckNoYXJ0R2VuZXJhdG9yID0gbmV3IFBvd2VyQ2hhcnRHZW5lcmF0b3IocG93ZXJTdHJlYW1zKTtcclxuICAgIHBvd2VyQ2hhcnRHZW5lcmF0b3IuY3JlYXRlUGllQ2hhcnQoKTtcclxuICAgIC8vYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBwb3dlckNoYXJ0R2VuZXJhdG9yLnRvZ2dsZVRpbWVVbml0cygpKTtcclxuICAgIHBvd2VyVG9nZ2xlQ2hhcnRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHBvd2VyQ2hhcnRHZW5lcmF0b3IudG9nZ2xlQ2hhcnRUeXBlKCkpO1xyXG5cclxuICAgIGxldCBockNoYXJ0R2VuZXJhdG9yID0gbmV3IEhlYXJ0UmF0ZUNoYXJ0R2VuZXJhdG9yKGhyU3RyZWFtcywgYWN0aXZpdGllcyk7XHJcbiAgICBockNoYXJ0R2VuZXJhdG9yLmNyZWF0ZVBpZUNoYXJ0KCk7XHJcbiAgICAvL2hyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBockNoYXJ0R2VuZXJhdG9yLnRvZ2dsZVRpbWVVbml0cygpKTtcclxuICAgIGhyVG9nZ2xlQ2hhcnRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGhyQ2hhcnRHZW5lcmF0b3IudG9nZ2xlQ2hhcnRUeXBlKCkpOyovXHJcblxyXG4gICAgYWRkU3RyZWFtc1RvQWN0aXZpdHkocG93ZXJTdHJlYW1zLCBoclN0cmVhbXMsIGFjdGl2aXRpZXMpO1xyXG4gICAgYWRkRGV0YWlsc1RvQWN0aXZpdHkoYWN0aXZpdGllcywgZGV0YWlsZWRBY3Rpdml0aWVzKTtcclxuICAgIGNvbnNvbGUubG9nKGFjdGl2aXRpZXMpO1xyXG4gICAgbGV0IGRhdGFDYWxjdWxhdG9yID0gbmV3IERhdGFDYWxjdWxhdG9yKGFjdGl2aXRpZXMpO1xyXG4gICAgZGF0YUNhbGN1bGF0b3Iuc2V0VGltZUluWm9uZUxpc3RzKCk7XHJcblxyXG4gICAgXHJcbiAgICAvL2RhdGFDYWxjdWxhdG9yLmZpbHRlckJ5RGF0ZShuZXcgRGF0ZSgyMDIzLCAwKS50b1N0cmluZygpLCBuZXcgRGF0ZSgyMDIzLCA2KS50b1N0cmluZygpKTtcclxuICAgIGRhdGFDYWxjdWxhdG9yLmZpbHRlckJ5RGF0ZShEYXRlSGVscGVyLnN1YkRheXMobmV3IERhdGUoKSwgMzApLCBuZXcgRGF0ZSgpKTtcclxuICAgIGxldCBmaWx0ZXJlZDMwZGF5cyA9IGRhdGFDYWxjdWxhdG9yLmhyVGltZUluWm9uZTtcclxuICAgIGNvbnNvbGUubG9nKFwiQWZ0ZXIgMzAgZGF5cyBmaWx0ZXJcIik7XHJcbiAgICBjb25zb2xlLmxvZyhmaWx0ZXJlZDMwZGF5cyk7XHJcbiAgICBkYXRhQ2FsY3VsYXRvci5maWx0ZXJCeURhdGUoRGF0ZUhlbHBlci5zdWJEYXlzKG5ldyBEYXRlKCksIDkwKSwgbmV3IERhdGUoKSk7XHJcbiAgICBsZXQgZmlsdGVyZWQ5MGRheXMgPSBkYXRhQ2FsY3VsYXRvci5oclRpbWVJblpvbmU7XHJcbiAgICBjb25zb2xlLmxvZyhcIkFmdGVyIDkwIGRheXMgZmlsdGVyXCIpO1xyXG4gICAgY29uc29sZS5sb2coZmlsdGVyZWQ5MGRheXMpO1xyXG4gICAgZGF0YUNhbGN1bGF0b3IuZmlsdGVyQnlEYXRlKERhdGVIZWxwZXIuc3ViWWVhcnMobmV3IERhdGUoKSwgMSksIG5ldyBEYXRlKCkpO1xyXG4gICAgbGV0IGZpbHRlcmVkMXllYXIgPSBkYXRhQ2FsY3VsYXRvci5oclRpbWVJblpvbmU7XHJcbiAgICBjb25zb2xlLmxvZyhcIkFmdGVyIDEgeWVhciBmaWx0ZXJcIik7XHJcbiAgICBjb25zb2xlLmxvZyhmaWx0ZXJlZDF5ZWFyKTtcclxuICAgIGRhdGFDYWxjdWxhdG9yLmZpbHRlckJ5RGF0ZShEYXRlSGVscGVyLnN1YlllYXJzKG5ldyBEYXRlKCksIDUpLCBuZXcgRGF0ZSgpKTtcclxuICAgIGxldCBmaWx0ZXJlZEFsbFRpbWUgPSBkYXRhQ2FsY3VsYXRvci5oclRpbWVJblpvbmU7XHJcbiAgICBjb25zb2xlLmxvZyhcIkFsbCB0aW1lXCIpO1xyXG4gICAgY29uc29sZS5sb2coZmlsdGVyZWRBbGxUaW1lKTtcclxufVxyXG5cclxuZnVuY3Rpb24gYWRkU3RyZWFtc1RvQWN0aXZpdHkocG93ZXJTdHJlYW1zOiBTdHJlYW1bXSwgaHJTdHJlYW1zOiBTdHJlYW1bXSwgYWN0aXZpdGllczogU3RyYXZhQWN0aXZpdHlbXSkge1xyXG4gICAgZm9yIChsZXQgYWN0aXZpdHkgb2YgYWN0aXZpdGllcykge1xyXG4gICAgICAgIGxldCBoclN0cmVhbVdpdGhJZCA9IGhyU3RyZWFtcy5maW5kKHN0cmVhbSA9PiBzdHJlYW0uaWQgPT0gYWN0aXZpdHkuaWQpO1xyXG4gICAgICAgIGxldCBwb3dlclN0cmVhbVdpdGhJZCA9IHBvd2VyU3RyZWFtcy5maW5kKHN0cmVhbSA9PiBzdHJlYW0uaWQgPT0gYWN0aXZpdHkuaWQpO1xyXG4gICAgICAgIGFjdGl2aXR5LnBvd2VyU3RyZWFtID0gcG93ZXJTdHJlYW1XaXRoSWQ/LnBvd2VyRGljdDtcclxuICAgICAgICBhY3Rpdml0eS5oclN0cmVhbSA9IGhyU3RyZWFtV2l0aElkPy5oZWFydFJhdGVEaWN0O1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBhZGREZXRhaWxzVG9BY3Rpdml0eShhY3Rpdml0aWVzOiBTdHJhdmFBY3Rpdml0eVtdLCBkZXRhaWxlZEFjdGl2aXRpZXMgOiBEZXRhaWxlZEFjdGl2aXR5W10pIHtcclxuICAgIGZvciAobGV0IGFjdGl2aXR5IG9mIGFjdGl2aXRpZXMpIHtcclxuICAgICAgICBsZXQgZGV0YWlscyA9IGRldGFpbGVkQWN0aXZpdGllcy5maW5kKGUgPT4gZS5pZCA9PSBhY3Rpdml0eS5pZCk7XHJcbiAgICAgICAgYWN0aXZpdHkuZGV0YWlscyA9IGRldGFpbHM7XHJcbiAgICB9XHJcbn1cclxuXHJcbihhc3luYyAoKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IG1haW4oKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xyXG4gICAgfVxyXG59KSgpO1xyXG4iXSwibmFtZXMiOlsiZ2V0UG93ZXJEYXRhIiwiZmV0Y2giLCJqc29uIiwiZ2V0SGVhcnRSYXRlRGF0YSIsImdldEFjdGl2aXRpZXMiLCJnZXREZXRhaWxlZEFjdGl2aXRpZXMiLCJfdHlwZW9mIiwib2JqIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJjb25zdHJ1Y3RvciIsInByb3RvdHlwZSIsInJlcXVpcmVkQXJncyIsInJlcXVpcmVkIiwiYXJncyIsImxlbmd0aCIsIlR5cGVFcnJvciIsInRvRGF0ZSIsImFyZ3VtZW50IiwiYXJndW1lbnRzIiwiYXJnU3RyIiwiT2JqZWN0IiwidG9TdHJpbmciLCJjYWxsIiwiRGF0ZSIsImdldFRpbWUiLCJjb25zb2xlIiwid2FybiIsIkVycm9yIiwic3RhY2siLCJOYU4iLCJpc0FmdGVyIiwiZGlydHlEYXRlIiwiZGlydHlEYXRlVG9Db21wYXJlIiwiZGF0ZSIsImRhdGVUb0NvbXBhcmUiLCJpc0JlZm9yZSIsImdldFRpbWVJblpvbmVMaXN0IiwiYWN0aXZpdGllcyIsInRpbWVJblpvbmVEaWN0IiwiYWN0aXZpdHkiLCJrZXkiLCJwb3dlclN0cmVhbSIsInRpbWVBdFBvd2VySW5TZWNvbmRzIiwidGhpcyIsImdldFpvbmUiLCJOdW1iZXIiLCJwYXJzZUludCIsInZhbHVlcyIsInBvd2VyIiwicG93ZXJBc051bWJlciIsInNldFBvd2VyWm9uZXMiLCJmdHAiLCJwb3dlclpvbmVzIiwiaHJTdHJlYW0iLCJoZWFydFJhdGUiLCJzZXRIclpvbmVzIiwibWF4SHIiLCJoclpvbmVzIiwiYWxsQWN0aXZpdGllcyIsImZpbHRlcmVkQWN0aXZpdGllcyIsImZpbHRlckJ5RGF0ZSIsImZyb21EYXRlIiwiYWN0aXZpdHlEYXRlIiwicGFyc2UiLCJzdGFydF9kYXRlX2xvY2FsIiwicHVzaCIsInNldFRpbWVJblpvbmVMaXN0cyIsInBvd2VyVGltZUluWm9uZSIsIlBvd2VyWm9uZSIsImhyVGltZUluWm9uZSIsIkhyWm9uZSIsInRvSW50ZWdlciIsImRpcnR5TnVtYmVyIiwibnVtYmVyIiwiaXNOYU4iLCJNYXRoIiwiY2VpbCIsImZsb29yIiwic3ViRGF5cyIsImRpcnR5QW1vdW50IiwiYW1vdW50Iiwic2V0RGF0ZSIsImdldERhdGUiLCJhZGREYXlzIiwic3ViWWVhcnMiLCJkYXlPZk1vbnRoIiwiZW5kT2ZEZXNpcmVkTW9udGgiLCJzZXRNb250aCIsImdldE1vbnRoIiwic2V0RnVsbFllYXIiLCJnZXRGdWxsWWVhciIsImFkZE1vbnRocyIsImFkZFllYXJzIiwibWFpbiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjbGllbnQiLCJTdHJhdmFBcGlDbGllbnQiLCJwb3dlclN0cmVhbXMiLCJoclN0cmVhbXMiLCJkZXRhaWxlZEFjdGl2aXRpZXMiLCJsb2ciLCJoclN0cmVhbVdpdGhJZCIsImZpbmQiLCJzdHJlYW0iLCJpZCIsInBvd2VyU3RyZWFtV2l0aElkIiwicG93ZXJEaWN0IiwiaGVhcnRSYXRlRGljdCIsImFkZFN0cmVhbXNUb0FjdGl2aXR5IiwiZGV0YWlscyIsImUiLCJhZGREZXRhaWxzVG9BY3Rpdml0eSIsImRhdGFDYWxjdWxhdG9yIiwiRGF0YUNhbGN1bGF0b3IiLCJmaWx0ZXJlZDMwZGF5cyIsImZpbHRlcmVkOTBkYXlzIiwiZmlsdGVyZWQxeWVhciIsImZpbHRlcmVkQWxsVGltZSIsImVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==